<div class="form-container">
  <form [formGroup]="patientForm">
    <p>Enter your new patients information.</p>

    <div class="top-inputs">
      <mat-form-field>
        <mat-label>First name</mat-label>
        <input matInput formControlName="firstName">
      </mat-form-field>

      <mat-form-field>
        <mat-label>Middle name</mat-label>
        <input matInput formControlName="middleName">
      </mat-form-field>

      <mat-form-field>
        <mat-label>Last name</mat-label>
        <input matInput formControlName="lastName">
      </mat-form-field>

      <mat-form-field>
        <mat-label>Date of Birth</mat-label>
        <input
          matInput
          [matDatepicker]="picker"
          formControlName="dateOfBirth"
        >
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
      </mat-form-field>

      <mat-form-field>
        <mat-label>Status</mat-label>
        <mat-select formControlName="status">
          <mat-option *ngFor="let status of statusOptions" [value]="status">{{ status }}</mat-option>
        </mat-select>
      </mat-form-field>
    </div>


    <div formArrayName="addresses" class="address-input-container">
      <div
        *ngFor="let address of addresses.controls; let i=index"
        [formGroupName]="i"
      >
        <p *ngIf="addresses.controls.length > 1">Address {{ i + 1 }}</p>

        <mat-form-field>
          <mat-label>Street</mat-label>
          <input matInput formControlName="street">
        </mat-form-field>

        <mat-form-field>
          <mat-label>City</mat-label>
          <input matInput formControlName="city">
        </mat-form-field>

        <mat-form-field class="state-selector">
          <mat-label>State</mat-label>
          <mat-select formControlName="state">
            <mat-option *ngFor="let state of stateOptions" [value]="state">{{ state }}</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field class="zip-input">
          <mat-label>Zip</mat-label>
          <input matInput formControlName="zip">
        </mat-form-field>

        <button
          *ngIf="(i + 1) == addresses.controls.length"
          mat-mini-fab
          matTooltip="Add additoinal address"
          (click)="addAddress()"
        >
          <mat-icon>add</mat-icon>
        </button>
      </div>
    </div>


    <div formArrayName="additionalFields">
      <div *ngFor="let field of additionalFields.controls; let i=index">
        <mat-form-field appearance="fill">
          <mat-label>Additional Field {{ i + 1 }}</mat-label>
          <input matInput [formControlName]="i">
        </mat-form-field>
      </div>
    </div>

    <button
      mat-flat-button
      (click)="addAdditionalField()"
    >
      Add additional patient info
    </button>

    <button
      mat-flat-button
      color="primary"
      (click)="savePatientRecord()"
    >
      Submit
    </button>
  </form>
</div>
